--
-- PostgreSQL database dump
--

-- Dumped from database version 16.9 (Ubuntu 16.9-0ubuntu0.24.04.1)
-- Dumped by pg_dump version 16.9 (Ubuntu 16.9-0ubuntu0.24.04.1)

-- Started on 2025-08-27 21:27:50 UTC

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 5 (class 2615 OID 2200)
-- Name: public; Type: SCHEMA; Schema: -; Owner: brbandeiras
--

-- *not* creating schema, since initdb creates it


ALTER SCHEMA public OWNER TO brbandeiras;

--
-- TOC entry 259 (class 1255 OID 17365)
-- Name: atualizar_tempo_producao(); Type: FUNCTION; Schema: public; Owner: brbandeiras
--

CREATE FUNCTION public.atualizar_tempo_producao() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    -- Atualizar tempo quando finalizar
    IF NEW.finalizado_em IS NOT NULL AND (OLD.finalizado_em IS NULL OR OLD.finalizado_em != NEW.finalizado_em) THEN
        IF NEW.iniciado_em IS NOT NULL THEN
            NEW.tempo_producao_minutos = EXTRACT(EPOCH FROM (NEW.finalizado_em - NEW.iniciado_em)) / 60;
        END IF;
    END IF;
    
    -- Sempre atualizar updated_at
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.atualizar_tempo_producao() OWNER TO brbandeiras;

--
-- TOC entry 260 (class 1255 OID 17502)
-- Name: update_updated_at_column(); Type: FUNCTION; Schema: public; Owner: brbandeiras
--

CREATE FUNCTION public.update_updated_at_column() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.update_updated_at_column() OWNER TO brbandeiras;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 250 (class 1259 OID 17182)
-- Name: anexos; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.anexos (
    id integer NOT NULL,
    entidade_tipo character varying(50) NOT NULL,
    entidade_id integer NOT NULL,
    nome_arquivo character varying(255) NOT NULL,
    nome_original character varying(255) NOT NULL,
    tamanho integer NOT NULL,
    mime_type character varying(100),
    usuario_id integer,
    descricao text,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.anexos OWNER TO brbandeiras;

--
-- TOC entry 3727 (class 0 OID 0)
-- Dependencies: 250
-- Name: TABLE anexos; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON TABLE public.anexos IS 'Arquivos anexados a diferentes entidades do sistema';


--
-- TOC entry 249 (class 1259 OID 17181)
-- Name: anexos_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.anexos_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.anexos_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3728 (class 0 OID 0)
-- Dependencies: 249
-- Name: anexos_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.anexos_id_seq OWNED BY public.anexos.id;


--
-- TOC entry 255 (class 1259 OID 17452)
-- Name: arte_versoes; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.arte_versoes (
    id integer NOT NULL,
    pedido_id integer NOT NULL,
    versao integer DEFAULT 1 NOT NULL,
    arquivo_nome character varying(255) NOT NULL,
    arquivo_caminho character varying(500) NOT NULL,
    aprovada boolean DEFAULT false,
    reprovada boolean DEFAULT false,
    comentario_arte text,
    comentario_cliente text,
    usuario_id integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.arte_versoes OWNER TO brbandeiras;

--
-- TOC entry 254 (class 1259 OID 17451)
-- Name: arte_versoes_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.arte_versoes_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.arte_versoes_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3729 (class 0 OID 0)
-- Dependencies: 254
-- Name: arte_versoes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.arte_versoes_id_seq OWNED BY public.arte_versoes.id;


--
-- TOC entry 232 (class 1259 OID 16971)
-- Name: categorias_estoque; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.categorias_estoque (
    id integer NOT NULL,
    nome character varying(100) NOT NULL,
    descricao text,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.categorias_estoque OWNER TO brbandeiras;

--
-- TOC entry 231 (class 1259 OID 16970)
-- Name: categorias_estoque_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.categorias_estoque_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.categorias_estoque_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3730 (class 0 OID 0)
-- Dependencies: 231
-- Name: categorias_estoque_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.categorias_estoque_id_seq OWNED BY public.categorias_estoque.id;


--
-- TOC entry 238 (class 1259 OID 17041)
-- Name: categorias_produtos; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.categorias_produtos (
    id integer NOT NULL,
    nome character varying(100) NOT NULL,
    descricao text,
    ativo boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.categorias_produtos OWNER TO brbandeiras;

--
-- TOC entry 237 (class 1259 OID 17040)
-- Name: categorias_produtos_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.categorias_produtos_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.categorias_produtos_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3731 (class 0 OID 0)
-- Dependencies: 237
-- Name: categorias_produtos_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.categorias_produtos_id_seq OWNED BY public.categorias_produtos.id;


--
-- TOC entry 218 (class 1259 OID 16827)
-- Name: clientes; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.clientes (
    id integer NOT NULL,
    nome character varying(200) NOT NULL,
    tipo_pessoa character(1) DEFAULT 'J'::bpchar,
    cpf_cnpj character varying(20),
    telefone character varying(20),
    email character varying(100),
    endereco text,
    observacoes text,
    ativo boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    whatsapp character varying(20),
    cep character varying(8),
    numero character varying(10),
    complemento character varying(100),
    bairro character varying(100),
    cidade character varying(100),
    estado character(2),
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.clientes OWNER TO brbandeiras;

--
-- TOC entry 217 (class 1259 OID 16826)
-- Name: clientes_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.clientes_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.clientes_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3732 (class 0 OID 0)
-- Dependencies: 217
-- Name: clientes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.clientes_id_seq OWNED BY public.clientes.id;


--
-- TOC entry 246 (class 1259 OID 17151)
-- Name: configuracoes; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.configuracoes (
    id integer NOT NULL,
    chave character varying(100) NOT NULL,
    valor text,
    descricao text,
    tipo character varying(20) DEFAULT 'string'::character varying,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT configuracoes_tipo_check CHECK (((tipo)::text = ANY ((ARRAY['string'::character varying, 'integer'::character varying, 'boolean'::character varying, 'json'::character varying, 'decimal'::character varying])::text[])))
);


ALTER TABLE public.configuracoes OWNER TO brbandeiras;

--
-- TOC entry 3733 (class 0 OID 0)
-- Dependencies: 246
-- Name: TABLE configuracoes; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON TABLE public.configuracoes IS 'Configurações globais do sistema';


--
-- TOC entry 245 (class 1259 OID 17150)
-- Name: configuracoes_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.configuracoes_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.configuracoes_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3734 (class 0 OID 0)
-- Dependencies: 245
-- Name: configuracoes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.configuracoes_id_seq OWNED BY public.configuracoes.id;


--
-- TOC entry 228 (class 1259 OID 16922)
-- Name: logs_acesso; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.logs_acesso (
    id integer NOT NULL,
    usuario_id integer,
    ip character varying(45),
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    acao character varying(20) DEFAULT 'login'::character varying,
    user_agent text,
    session_id character varying(128)
);


ALTER TABLE public.logs_acesso OWNER TO brbandeiras;

--
-- TOC entry 227 (class 1259 OID 16921)
-- Name: logs_acesso_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.logs_acesso_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.logs_acesso_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3735 (class 0 OID 0)
-- Dependencies: 227
-- Name: logs_acesso_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.logs_acesso_id_seq OWNED BY public.logs_acesso.id;


--
-- TOC entry 230 (class 1259 OID 16952)
-- Name: logs_sistema; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.logs_sistema (
    id integer NOT NULL,
    usuario_id integer,
    acao character varying(50) NOT NULL,
    detalhes text,
    ip character varying(45),
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.logs_sistema OWNER TO brbandeiras;

--
-- TOC entry 229 (class 1259 OID 16951)
-- Name: logs_sistema_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.logs_sistema_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.logs_sistema_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3736 (class 0 OID 0)
-- Dependencies: 229
-- Name: logs_sistema_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.logs_sistema_id_seq OWNED BY public.logs_sistema.id;


--
-- TOC entry 236 (class 1259 OID 17006)
-- Name: movimentacoes_estoque; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.movimentacoes_estoque (
    id integer NOT NULL,
    produto_id integer,
    tipo character varying(20) NOT NULL,
    quantidade numeric(10,2) NOT NULL,
    quantidade_anterior numeric(10,2),
    quantidade_posterior numeric(10,2),
    pedido_id integer,
    observacoes text,
    usuario_id integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.movimentacoes_estoque OWNER TO brbandeiras;

--
-- TOC entry 235 (class 1259 OID 17005)
-- Name: movimentacoes_estoque_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.movimentacoes_estoque_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.movimentacoes_estoque_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3737 (class 0 OID 0)
-- Dependencies: 235
-- Name: movimentacoes_estoque_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.movimentacoes_estoque_id_seq OWNED BY public.movimentacoes_estoque.id;


--
-- TOC entry 248 (class 1259 OID 17166)
-- Name: notificacoes; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.notificacoes (
    id integer NOT NULL,
    usuario_id integer NOT NULL,
    tipo character varying(50) NOT NULL,
    titulo character varying(200) NOT NULL,
    mensagem text,
    link character varying(255),
    lida boolean DEFAULT false,
    lida_em timestamp without time zone,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.notificacoes OWNER TO brbandeiras;

--
-- TOC entry 3738 (class 0 OID 0)
-- Dependencies: 248
-- Name: TABLE notificacoes; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON TABLE public.notificacoes IS 'Notificações para os usuários';


--
-- TOC entry 247 (class 1259 OID 17165)
-- Name: notificacoes_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.notificacoes_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.notificacoes_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3739 (class 0 OID 0)
-- Dependencies: 247
-- Name: notificacoes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.notificacoes_id_seq OWNED BY public.notificacoes.id;


--
-- TOC entry 224 (class 1259 OID 16882)
-- Name: pedido_arquivos; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.pedido_arquivos (
    id integer NOT NULL,
    pedido_id integer,
    nome_arquivo character varying(255) NOT NULL,
    caminho character varying(500) NOT NULL,
    tipo character varying(50),
    tamanho integer,
    uploaded_by integer,
    uploaded_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    descricao text,
    usuario_id integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    caminho_arquivo character varying(500)
);


ALTER TABLE public.pedido_arquivos OWNER TO brbandeiras;

--
-- TOC entry 223 (class 1259 OID 16881)
-- Name: pedido_arquivos_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.pedido_arquivos_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.pedido_arquivos_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3740 (class 0 OID 0)
-- Dependencies: 223
-- Name: pedido_arquivos_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.pedido_arquivos_id_seq OWNED BY public.pedido_arquivos.id;


--
-- TOC entry 257 (class 1259 OID 17477)
-- Name: pedido_arte; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.pedido_arte (
    id integer NOT NULL,
    pedido_id integer NOT NULL,
    arte_finalista_id integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.pedido_arte OWNER TO brbandeiras;

--
-- TOC entry 256 (class 1259 OID 17476)
-- Name: pedido_arte_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.pedido_arte_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.pedido_arte_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3741 (class 0 OID 0)
-- Dependencies: 256
-- Name: pedido_arte_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.pedido_arte_id_seq OWNED BY public.pedido_arte.id;


--
-- TOC entry 222 (class 1259 OID 16867)
-- Name: pedido_itens; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.pedido_itens (
    id integer NOT NULL,
    pedido_id integer,
    descricao character varying(500) NOT NULL,
    quantidade integer DEFAULT 1 NOT NULL,
    valor_unitario numeric(10,2) NOT NULL,
    valor_total numeric(10,2) NOT NULL,
    observacoes text,
    produto_id integer,
    CONSTRAINT check_quantidade_inteira CHECK (((quantidade)::double precision = floor((quantidade)::double precision)))
);


ALTER TABLE public.pedido_itens OWNER TO brbandeiras;

--
-- TOC entry 221 (class 1259 OID 16866)
-- Name: pedido_itens_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.pedido_itens_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.pedido_itens_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3742 (class 0 OID 0)
-- Dependencies: 221
-- Name: pedido_itens_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.pedido_itens_id_seq OWNED BY public.pedido_itens.id;


--
-- TOC entry 220 (class 1259 OID 16839)
-- Name: pedidos; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.pedidos (
    id integer NOT NULL,
    numero character varying(30) NOT NULL,
    cliente_id integer,
    vendedor_id integer,
    valor_total numeric(10,2) DEFAULT 0 NOT NULL,
    desconto numeric(10,2) DEFAULT 0,
    valor_final numeric(10,2) DEFAULT 0 NOT NULL,
    status character varying(20) DEFAULT 'orcamento'::character varying,
    urgente boolean DEFAULT false,
    prazo_entrega date,
    observacoes text,
    motivo_cancelamento text,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    data_aprovacao timestamp without time zone,
    arte_finalista_id integer,
    responsavel_atual_id integer,
    responsavel_producao_id integer,
    iniciado_producao_em timestamp without time zone,
    finalizado_producao_em timestamp without time zone,
    forma_pagamento character varying(50),
    condicoes_pagamento character varying(255),
    data_pagamento_entrada timestamp without time zone,
    data_pagamento_final timestamp without time zone,
    CONSTRAINT pedidos_status_check CHECK (((status)::text = ANY ((ARRAY['orcamento'::character varying, 'aprovado'::character varying, 'pagamento_50'::character varying, 'producao'::character varying, 'pagamento_100'::character varying, 'pronto'::character varying, 'entregue'::character varying, 'cancelado'::character varying])::text[])))
);


ALTER TABLE public.pedidos OWNER TO brbandeiras;

--
-- TOC entry 219 (class 1259 OID 16838)
-- Name: pedidos_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.pedidos_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.pedidos_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3743 (class 0 OID 0)
-- Dependencies: 219
-- Name: pedidos_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.pedidos_id_seq OWNED BY public.pedidos.id;


--
-- TOC entry 252 (class 1259 OID 17332)
-- Name: producao_checklist; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.producao_checklist (
    id integer NOT NULL,
    pedido_id integer,
    corte boolean DEFAULT false,
    costura boolean DEFAULT false,
    acabamento boolean DEFAULT false,
    qualidade boolean DEFAULT false,
    observacoes text,
    responsavel_id integer,
    iniciado_em timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    finalizado_em timestamp without time zone,
    tempo_producao_minutos integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.producao_checklist OWNER TO brbandeiras;

--
-- TOC entry 3744 (class 0 OID 0)
-- Dependencies: 252
-- Name: TABLE producao_checklist; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON TABLE public.producao_checklist IS 'Controle de checklist e progresso na produção';


--
-- TOC entry 3745 (class 0 OID 0)
-- Dependencies: 252
-- Name: COLUMN producao_checklist.tempo_producao_minutos; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON COLUMN public.producao_checklist.tempo_producao_minutos IS 'Tempo total em produção calculado automaticamente';


--
-- TOC entry 251 (class 1259 OID 17331)
-- Name: producao_checklist_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.producao_checklist_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.producao_checklist_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3746 (class 0 OID 0)
-- Dependencies: 251
-- Name: producao_checklist_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.producao_checklist_id_seq OWNED BY public.producao_checklist.id;


--
-- TOC entry 226 (class 1259 OID 16902)
-- Name: producao_status; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.producao_status (
    id integer NOT NULL,
    pedido_id integer,
    status character varying(20) NOT NULL,
    observacoes text,
    usuario_id integer,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.producao_status OWNER TO brbandeiras;

--
-- TOC entry 225 (class 1259 OID 16901)
-- Name: producao_status_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.producao_status_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.producao_status_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3747 (class 0 OID 0)
-- Dependencies: 225
-- Name: producao_status_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.producao_status_id_seq OWNED BY public.producao_status.id;


--
-- TOC entry 240 (class 1259 OID 17054)
-- Name: produtos_catalogo; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.produtos_catalogo (
    id integer NOT NULL,
    codigo character varying(50) NOT NULL,
    nome character varying(200) NOT NULL,
    descricao text,
    categoria_id integer,
    preco numeric(10,2) DEFAULT 0 NOT NULL,
    preco_promocional numeric(10,2),
    unidade_venda character varying(20) DEFAULT 'UN'::character varying,
    tempo_producao integer DEFAULT 1,
    estoque_disponivel boolean DEFAULT true,
    imagem_principal character varying(255),
    especificacoes jsonb,
    tags character varying(255),
    popularidade integer DEFAULT 0,
    ativo boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.produtos_catalogo OWNER TO brbandeiras;

--
-- TOC entry 239 (class 1259 OID 17053)
-- Name: produtos_catalogo_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.produtos_catalogo_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.produtos_catalogo_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3748 (class 0 OID 0)
-- Dependencies: 239
-- Name: produtos_catalogo_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.produtos_catalogo_id_seq OWNED BY public.produtos_catalogo.id;


--
-- TOC entry 234 (class 1259 OID 16983)
-- Name: produtos_estoque; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.produtos_estoque (
    id integer NOT NULL,
    codigo character varying(50) NOT NULL,
    nome character varying(200) NOT NULL,
    descricao text,
    categoria_id integer,
    unidade_medida character varying(10) NOT NULL,
    quantidade_atual numeric(10,2) DEFAULT 0 NOT NULL,
    estoque_minimo numeric(10,2) DEFAULT 0 NOT NULL,
    estoque_maximo numeric(10,2) DEFAULT 0 NOT NULL,
    valor_unitario numeric(10,2) DEFAULT 0 NOT NULL,
    fornecedor_principal character varying(200),
    localizacao_corredor character varying(10),
    localizacao_prateleira character varying(10),
    localizacao_gaveta character varying(10),
    observacoes text,
    ativo boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.produtos_estoque OWNER TO brbandeiras;

--
-- TOC entry 233 (class 1259 OID 16982)
-- Name: produtos_estoque_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.produtos_estoque_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.produtos_estoque_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3749 (class 0 OID 0)
-- Dependencies: 233
-- Name: produtos_estoque_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.produtos_estoque_id_seq OWNED BY public.produtos_estoque.id;


--
-- TOC entry 242 (class 1259 OID 17078)
-- Name: produtos_imagens; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.produtos_imagens (
    id integer NOT NULL,
    produto_id integer,
    caminho character varying(255) NOT NULL,
    descricao character varying(255),
    ordem integer DEFAULT 0,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.produtos_imagens OWNER TO brbandeiras;

--
-- TOC entry 241 (class 1259 OID 17077)
-- Name: produtos_imagens_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.produtos_imagens_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.produtos_imagens_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3750 (class 0 OID 0)
-- Dependencies: 241
-- Name: produtos_imagens_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.produtos_imagens_id_seq OWNED BY public.produtos_imagens.id;


--
-- TOC entry 244 (class 1259 OID 17136)
-- Name: sistema_logs; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.sistema_logs (
    id integer NOT NULL,
    usuario_id integer,
    acao character varying(100) NOT NULL,
    descricao text,
    ip character varying(45),
    user_agent text,
    dados_extras jsonb,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP
);


ALTER TABLE public.sistema_logs OWNER TO brbandeiras;

--
-- TOC entry 3751 (class 0 OID 0)
-- Dependencies: 244
-- Name: TABLE sistema_logs; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON TABLE public.sistema_logs IS 'Registro de todas as ações importantes do sistema';


--
-- TOC entry 243 (class 1259 OID 17135)
-- Name: sistema_logs_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.sistema_logs_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.sistema_logs_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3752 (class 0 OID 0)
-- Dependencies: 243
-- Name: sistema_logs_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.sistema_logs_id_seq OWNED BY public.sistema_logs.id;


--
-- TOC entry 216 (class 1259 OID 16816)
-- Name: usuarios; Type: TABLE; Schema: public; Owner: brbandeiras
--

CREATE TABLE public.usuarios (
    id integer NOT NULL,
    nome character varying(100) NOT NULL,
    email character varying(100) NOT NULL,
    senha character varying(255) NOT NULL,
    perfil character varying(20) NOT NULL,
    ativo boolean DEFAULT true,
    created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    telefone character varying(20),
    observacoes text,
    forcar_troca_senha boolean DEFAULT false,
    updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
    ultimo_acesso timestamp without time zone,
    foto_perfil character varying(500)
);


ALTER TABLE public.usuarios OWNER TO brbandeiras;

--
-- TOC entry 215 (class 1259 OID 16815)
-- Name: usuarios_id_seq; Type: SEQUENCE; Schema: public; Owner: brbandeiras
--

CREATE SEQUENCE public.usuarios_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.usuarios_id_seq OWNER TO brbandeiras;

--
-- TOC entry 3753 (class 0 OID 0)
-- Dependencies: 215
-- Name: usuarios_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: brbandeiras
--

ALTER SEQUENCE public.usuarios_id_seq OWNED BY public.usuarios.id;


--
-- TOC entry 258 (class 1259 OID 17507)
-- Name: v_pedidos_completos; Type: VIEW; Schema: public; Owner: brbandeiras
--

CREATE VIEW public.v_pedidos_completos AS
 SELECT p.id,
    p.numero,
    p.status,
    p.urgente,
    p.prazo_entrega,
    p.valor_total,
    p.desconto,
    p.valor_final,
    p.forma_pagamento,
    p.condicoes_pagamento,
    p.observacoes,
    p.created_at,
    p.updated_at,
    c.id AS cliente_id,
    c.nome AS cliente_nome,
    c.telefone AS cliente_telefone,
    c.email AS cliente_email,
    c.cpf_cnpj AS cliente_cpf_cnpj,
    c.endereco AS cliente_endereco,
    c.cidade AS cliente_cidade,
    c.estado AS cliente_estado,
    c.cep AS cliente_cep,
    u.id AS vendedor_id,
    u.nome AS vendedor_nome,
    u.email AS vendedor_email,
    count(DISTINCT pi.id) AS total_itens,
    count(DISTINCT paq.id) AS total_arquivos,
    count(DISTINCT av.id) AS total_versoes_arte
   FROM (((((public.pedidos p
     LEFT JOIN public.clientes c ON ((p.cliente_id = c.id)))
     LEFT JOIN public.usuarios u ON ((p.vendedor_id = u.id)))
     LEFT JOIN public.pedido_itens pi ON ((pi.pedido_id = p.id)))
     LEFT JOIN public.pedido_arquivos paq ON ((paq.pedido_id = p.id)))
     LEFT JOIN public.arte_versoes av ON ((av.pedido_id = p.id)))
  GROUP BY p.id, p.numero, p.status, p.urgente, p.prazo_entrega, p.valor_total, p.desconto, p.valor_final, p.forma_pagamento, p.condicoes_pagamento, p.observacoes, p.created_at, p.updated_at, c.id, c.nome, c.telefone, c.email, c.cpf_cnpj, c.endereco, c.cidade, c.estado, c.cep, u.id, u.nome, u.email;


ALTER VIEW public.v_pedidos_completos OWNER TO brbandeiras;

--
-- TOC entry 253 (class 1259 OID 17360)
-- Name: view_kanban_producao; Type: VIEW; Schema: public; Owner: brbandeiras
--

CREATE VIEW public.view_kanban_producao AS
 SELECT p.id,
    p.numero,
    p.status,
    p.urgente,
    p.prazo_entrega,
    p.observacoes,
    p.created_at,
    p.responsavel_producao_id,
    p.iniciado_producao_em,
    p.finalizado_producao_em,
    c.nome AS cliente_nome,
    u_vendedor.nome AS vendedor_nome,
    u_responsavel.nome AS responsavel_nome,
    string_agg(DISTINCT (pi.descricao)::text, ', '::text) AS produtos,
    COALESCE(pc.corte, false) AS corte,
    COALESCE(pc.costura, false) AS costura,
    COALESCE(pc.acabamento, false) AS acabamento,
    COALESCE(pc.qualidade, false) AS qualidade,
    pc.observacoes AS observacoes_producao,
    pc.tempo_producao_minutos,
        CASE
            WHEN (p.prazo_entrega IS NOT NULL) THEN (p.prazo_entrega - CURRENT_DATE)
            ELSE NULL::integer
        END AS dias_ate_prazo,
        CASE
            WHEN ((COALESCE(pc.corte, false) = true) AND (COALESCE(pc.costura, false) = true) AND (COALESCE(pc.acabamento, false) = true) AND (COALESCE(pc.qualidade, false) = true)) THEN 'completo'::text
            WHEN ((COALESCE(pc.corte, false) = true) OR (COALESCE(pc.costura, false) = true) OR (COALESCE(pc.acabamento, false) = true) OR (COALESCE(pc.qualidade, false) = true)) THEN 'parcial'::text
            ELSE 'vazio'::text
        END AS status_checklist,
    (((
        CASE
            WHEN COALESCE(pc.corte, false) THEN 1
            ELSE 0
        END +
        CASE
            WHEN COALESCE(pc.costura, false) THEN 1
            ELSE 0
        END) +
        CASE
            WHEN COALESCE(pc.acabamento, false) THEN 1
            ELSE 0
        END) +
        CASE
            WHEN COALESCE(pc.qualidade, false) THEN 1
            ELSE 0
        END) AS progresso_checklist
   FROM (((((public.pedidos p
     LEFT JOIN public.clientes c ON ((p.cliente_id = c.id)))
     LEFT JOIN public.usuarios u_vendedor ON ((p.vendedor_id = u_vendedor.id)))
     LEFT JOIN public.usuarios u_responsavel ON ((p.responsavel_producao_id = u_responsavel.id)))
     LEFT JOIN public.pedido_itens pi ON ((p.id = pi.pedido_id)))
     LEFT JOIN public.producao_checklist pc ON ((p.id = pc.pedido_id)))
  WHERE ((p.status)::text = ANY ((ARRAY['aprovado'::character varying, 'producao'::character varying, 'finalizado'::character varying])::text[]))
  GROUP BY p.id, p.numero, p.status, p.urgente, p.prazo_entrega, p.observacoes, p.created_at, p.responsavel_producao_id, p.iniciado_producao_em, p.finalizado_producao_em, c.nome, u_vendedor.nome, u_responsavel.nome, pc.corte, pc.costura, pc.acabamento, pc.qualidade, pc.observacoes, pc.tempo_producao_minutos;


ALTER VIEW public.view_kanban_producao OWNER TO brbandeiras;

--
-- TOC entry 3754 (class 0 OID 0)
-- Dependencies: 253
-- Name: VIEW view_kanban_producao; Type: COMMENT; Schema: public; Owner: brbandeiras
--

COMMENT ON VIEW public.view_kanban_producao IS 'View otimizada para o sistema Kanban de produção';


--
-- TOC entry 3425 (class 2604 OID 17185)
-- Name: anexos id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.anexos ALTER COLUMN id SET DEFAULT nextval('public.anexos_id_seq'::regclass);


--
-- TOC entry 3435 (class 2604 OID 17455)
-- Name: arte_versoes id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.arte_versoes ALTER COLUMN id SET DEFAULT nextval('public.arte_versoes_id_seq'::regclass);


--
-- TOC entry 3389 (class 2604 OID 16974)
-- Name: categorias_estoque id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.categorias_estoque ALTER COLUMN id SET DEFAULT nextval('public.categorias_estoque_id_seq'::regclass);


--
-- TOC entry 3401 (class 2604 OID 17044)
-- Name: categorias_produtos id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.categorias_produtos ALTER COLUMN id SET DEFAULT nextval('public.categorias_produtos_id_seq'::regclass);


--
-- TOC entry 3364 (class 2604 OID 16830)
-- Name: clientes id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.clientes ALTER COLUMN id SET DEFAULT nextval('public.clientes_id_seq'::regclass);


--
-- TOC entry 3418 (class 2604 OID 17154)
-- Name: configuracoes id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.configuracoes ALTER COLUMN id SET DEFAULT nextval('public.configuracoes_id_seq'::regclass);


--
-- TOC entry 3384 (class 2604 OID 16925)
-- Name: logs_acesso id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.logs_acesso ALTER COLUMN id SET DEFAULT nextval('public.logs_acesso_id_seq'::regclass);


--
-- TOC entry 3387 (class 2604 OID 16955)
-- Name: logs_sistema id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.logs_sistema ALTER COLUMN id SET DEFAULT nextval('public.logs_sistema_id_seq'::regclass);


--
-- TOC entry 3399 (class 2604 OID 17009)
-- Name: movimentacoes_estoque id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.movimentacoes_estoque ALTER COLUMN id SET DEFAULT nextval('public.movimentacoes_estoque_id_seq'::regclass);


--
-- TOC entry 3422 (class 2604 OID 17169)
-- Name: notificacoes id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.notificacoes ALTER COLUMN id SET DEFAULT nextval('public.notificacoes_id_seq'::regclass);


--
-- TOC entry 3379 (class 2604 OID 16885)
-- Name: pedido_arquivos id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arquivos ALTER COLUMN id SET DEFAULT nextval('public.pedido_arquivos_id_seq'::regclass);


--
-- TOC entry 3440 (class 2604 OID 17480)
-- Name: pedido_arte id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arte ALTER COLUMN id SET DEFAULT nextval('public.pedido_arte_id_seq'::regclass);


--
-- TOC entry 3377 (class 2604 OID 16870)
-- Name: pedido_itens id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_itens ALTER COLUMN id SET DEFAULT nextval('public.pedido_itens_id_seq'::regclass);


--
-- TOC entry 3369 (class 2604 OID 16842)
-- Name: pedidos id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos ALTER COLUMN id SET DEFAULT nextval('public.pedidos_id_seq'::regclass);


--
-- TOC entry 3427 (class 2604 OID 17335)
-- Name: producao_checklist id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_checklist ALTER COLUMN id SET DEFAULT nextval('public.producao_checklist_id_seq'::regclass);


--
-- TOC entry 3382 (class 2604 OID 16905)
-- Name: producao_status id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_status ALTER COLUMN id SET DEFAULT nextval('public.producao_status_id_seq'::regclass);


--
-- TOC entry 3404 (class 2604 OID 17057)
-- Name: produtos_catalogo id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_catalogo ALTER COLUMN id SET DEFAULT nextval('public.produtos_catalogo_id_seq'::regclass);


--
-- TOC entry 3391 (class 2604 OID 16986)
-- Name: produtos_estoque id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_estoque ALTER COLUMN id SET DEFAULT nextval('public.produtos_estoque_id_seq'::regclass);


--
-- TOC entry 3413 (class 2604 OID 17081)
-- Name: produtos_imagens id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_imagens ALTER COLUMN id SET DEFAULT nextval('public.produtos_imagens_id_seq'::regclass);


--
-- TOC entry 3416 (class 2604 OID 17139)
-- Name: sistema_logs id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.sistema_logs ALTER COLUMN id SET DEFAULT nextval('public.sistema_logs_id_seq'::regclass);


--
-- TOC entry 3359 (class 2604 OID 16819)
-- Name: usuarios id; Type: DEFAULT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.usuarios ALTER COLUMN id SET DEFAULT nextval('public.usuarios_id_seq'::regclass);


--
-- TOC entry 3527 (class 2606 OID 17190)
-- Name: anexos anexos_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.anexos
    ADD CONSTRAINT anexos_pkey PRIMARY KEY (id);


--
-- TOC entry 3534 (class 2606 OID 17465)
-- Name: arte_versoes arte_versoes_pedido_id_versao_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.arte_versoes
    ADD CONSTRAINT arte_versoes_pedido_id_versao_key UNIQUE (pedido_id, versao);


--
-- TOC entry 3536 (class 2606 OID 17463)
-- Name: arte_versoes arte_versoes_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.arte_versoes
    ADD CONSTRAINT arte_versoes_pkey PRIMARY KEY (id);


--
-- TOC entry 3486 (class 2606 OID 16981)
-- Name: categorias_estoque categorias_estoque_nome_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.categorias_estoque
    ADD CONSTRAINT categorias_estoque_nome_key UNIQUE (nome);


--
-- TOC entry 3488 (class 2606 OID 16979)
-- Name: categorias_estoque categorias_estoque_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.categorias_estoque
    ADD CONSTRAINT categorias_estoque_pkey PRIMARY KEY (id);


--
-- TOC entry 3502 (class 2606 OID 17052)
-- Name: categorias_produtos categorias_produtos_nome_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.categorias_produtos
    ADD CONSTRAINT categorias_produtos_nome_key UNIQUE (nome);


--
-- TOC entry 3504 (class 2606 OID 17050)
-- Name: categorias_produtos categorias_produtos_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.categorias_produtos
    ADD CONSTRAINT categorias_produtos_pkey PRIMARY KEY (id);


--
-- TOC entry 3453 (class 2606 OID 16837)
-- Name: clientes clientes_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.clientes
    ADD CONSTRAINT clientes_pkey PRIMARY KEY (id);


--
-- TOC entry 3519 (class 2606 OID 17164)
-- Name: configuracoes configuracoes_chave_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.configuracoes
    ADD CONSTRAINT configuracoes_chave_key UNIQUE (chave);


--
-- TOC entry 3521 (class 2606 OID 17162)
-- Name: configuracoes configuracoes_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.configuracoes
    ADD CONSTRAINT configuracoes_pkey PRIMARY KEY (id);


--
-- TOC entry 3478 (class 2606 OID 16928)
-- Name: logs_acesso logs_acesso_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.logs_acesso
    ADD CONSTRAINT logs_acesso_pkey PRIMARY KEY (id);


--
-- TOC entry 3484 (class 2606 OID 16960)
-- Name: logs_sistema logs_sistema_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.logs_sistema
    ADD CONSTRAINT logs_sistema_pkey PRIMARY KEY (id);


--
-- TOC entry 3500 (class 2606 OID 17014)
-- Name: movimentacoes_estoque movimentacoes_estoque_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.movimentacoes_estoque
    ADD CONSTRAINT movimentacoes_estoque_pkey PRIMARY KEY (id);


--
-- TOC entry 3525 (class 2606 OID 17175)
-- Name: notificacoes notificacoes_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.notificacoes
    ADD CONSTRAINT notificacoes_pkey PRIMARY KEY (id);


--
-- TOC entry 3472 (class 2606 OID 16890)
-- Name: pedido_arquivos pedido_arquivos_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arquivos
    ADD CONSTRAINT pedido_arquivos_pkey PRIMARY KEY (id);


--
-- TOC entry 3540 (class 2606 OID 17486)
-- Name: pedido_arte pedido_arte_pedido_id_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arte
    ADD CONSTRAINT pedido_arte_pedido_id_key UNIQUE (pedido_id);


--
-- TOC entry 3542 (class 2606 OID 17484)
-- Name: pedido_arte pedido_arte_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arte
    ADD CONSTRAINT pedido_arte_pkey PRIMARY KEY (id);


--
-- TOC entry 3470 (class 2606 OID 16875)
-- Name: pedido_itens pedido_itens_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_itens
    ADD CONSTRAINT pedido_itens_pkey PRIMARY KEY (id);


--
-- TOC entry 3465 (class 2606 OID 17039)
-- Name: pedidos pedidos_numero_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_numero_key UNIQUE (numero);


--
-- TOC entry 3467 (class 2606 OID 16853)
-- Name: pedidos pedidos_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_pkey PRIMARY KEY (id);


--
-- TOC entry 3532 (class 2606 OID 17346)
-- Name: producao_checklist producao_checklist_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_checklist
    ADD CONSTRAINT producao_checklist_pkey PRIMARY KEY (id);


--
-- TOC entry 3475 (class 2606 OID 16910)
-- Name: producao_status producao_status_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_status
    ADD CONSTRAINT producao_status_pkey PRIMARY KEY (id);


--
-- TOC entry 3508 (class 2606 OID 17071)
-- Name: produtos_catalogo produtos_catalogo_codigo_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_catalogo
    ADD CONSTRAINT produtos_catalogo_codigo_key UNIQUE (codigo);


--
-- TOC entry 3510 (class 2606 OID 17069)
-- Name: produtos_catalogo produtos_catalogo_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_catalogo
    ADD CONSTRAINT produtos_catalogo_pkey PRIMARY KEY (id);


--
-- TOC entry 3493 (class 2606 OID 16999)
-- Name: produtos_estoque produtos_estoque_codigo_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_estoque
    ADD CONSTRAINT produtos_estoque_codigo_key UNIQUE (codigo);


--
-- TOC entry 3495 (class 2606 OID 16997)
-- Name: produtos_estoque produtos_estoque_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_estoque
    ADD CONSTRAINT produtos_estoque_pkey PRIMARY KEY (id);


--
-- TOC entry 3512 (class 2606 OID 17087)
-- Name: produtos_imagens produtos_imagens_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_imagens
    ADD CONSTRAINT produtos_imagens_pkey PRIMARY KEY (id);


--
-- TOC entry 3517 (class 2606 OID 17144)
-- Name: sistema_logs sistema_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.sistema_logs
    ADD CONSTRAINT sistema_logs_pkey PRIMARY KEY (id);


--
-- TOC entry 3449 (class 2606 OID 16825)
-- Name: usuarios usuarios_email_key; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.usuarios
    ADD CONSTRAINT usuarios_email_key UNIQUE (email);


--
-- TOC entry 3451 (class 2606 OID 16823)
-- Name: usuarios usuarios_pkey; Type: CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.usuarios
    ADD CONSTRAINT usuarios_pkey PRIMARY KEY (id);


--
-- TOC entry 3528 (class 1259 OID 17201)
-- Name: idx_anexos_entidade; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_anexos_entidade ON public.anexos USING btree (entidade_tipo, entidade_id);


--
-- TOC entry 3537 (class 1259 OID 17499)
-- Name: idx_arte_versoes_pedido; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_arte_versoes_pedido ON public.arte_versoes USING btree (pedido_id);


--
-- TOC entry 3454 (class 1259 OID 17498)
-- Name: idx_clientes_cidade_estado; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_clientes_cidade_estado ON public.clientes USING btree (cidade, estado);


--
-- TOC entry 3455 (class 1259 OID 16945)
-- Name: idx_clientes_cpf_cnpj; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_clientes_cpf_cnpj ON public.clientes USING btree (cpf_cnpj);


--
-- TOC entry 3456 (class 1259 OID 16946)
-- Name: idx_clientes_email; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_clientes_email ON public.clientes USING btree (email);


--
-- TOC entry 3457 (class 1259 OID 16944)
-- Name: idx_clientes_nome; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_clientes_nome ON public.clientes USING btree (nome);


--
-- TOC entry 3479 (class 1259 OID 16967)
-- Name: idx_logs_acao; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_logs_acao ON public.logs_sistema USING btree (acao);


--
-- TOC entry 3480 (class 1259 OID 17501)
-- Name: idx_logs_created; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_logs_created ON public.logs_sistema USING btree (created_at);


--
-- TOC entry 3481 (class 1259 OID 17037)
-- Name: idx_logs_data; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_logs_data ON public.logs_sistema USING btree (created_at);


--
-- TOC entry 3482 (class 1259 OID 16966)
-- Name: idx_logs_usuario; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_logs_usuario ON public.logs_sistema USING btree (usuario_id);


--
-- TOC entry 3476 (class 1259 OID 16942)
-- Name: idx_logs_usuario_acao; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_logs_usuario_acao ON public.logs_acesso USING btree (usuario_id, acao, created_at);


--
-- TOC entry 3496 (class 1259 OID 17035)
-- Name: idx_movimentacoes_data; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_movimentacoes_data ON public.movimentacoes_estoque USING btree (created_at);


--
-- TOC entry 3497 (class 1259 OID 17033)
-- Name: idx_movimentacoes_produto; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_movimentacoes_produto ON public.movimentacoes_estoque USING btree (produto_id);


--
-- TOC entry 3498 (class 1259 OID 17034)
-- Name: idx_movimentacoes_tipo; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_movimentacoes_tipo ON public.movimentacoes_estoque USING btree (tipo);


--
-- TOC entry 3522 (class 1259 OID 17200)
-- Name: idx_notificacoes_lida; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_notificacoes_lida ON public.notificacoes USING btree (lida);


--
-- TOC entry 3523 (class 1259 OID 17199)
-- Name: idx_notificacoes_usuario_id; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_notificacoes_usuario_id ON public.notificacoes USING btree (usuario_id);


--
-- TOC entry 3538 (class 1259 OID 17500)
-- Name: idx_pedido_arte_pedido; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedido_arte_pedido ON public.pedido_arte USING btree (pedido_id);


--
-- TOC entry 3468 (class 1259 OID 17100)
-- Name: idx_pedido_itens_produto; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedido_itens_produto ON public.pedido_itens USING btree (produto_id);


--
-- TOC entry 3458 (class 1259 OID 16936)
-- Name: idx_pedidos_cliente; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedidos_cliente ON public.pedidos USING btree (cliente_id);


--
-- TOC entry 3459 (class 1259 OID 17497)
-- Name: idx_pedidos_created; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedidos_created ON public.pedidos USING btree (created_at);


--
-- TOC entry 3460 (class 1259 OID 16937)
-- Name: idx_pedidos_prazo; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedidos_prazo ON public.pedidos USING btree (prazo_entrega);


--
-- TOC entry 3461 (class 1259 OID 17359)
-- Name: idx_pedidos_responsavel_producao; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedidos_responsavel_producao ON public.pedidos USING btree (responsavel_producao_id);


--
-- TOC entry 3462 (class 1259 OID 16934)
-- Name: idx_pedidos_status; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedidos_status ON public.pedidos USING btree (status);


--
-- TOC entry 3463 (class 1259 OID 16935)
-- Name: idx_pedidos_vendedor; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_pedidos_vendedor ON public.pedidos USING btree (vendedor_id);


--
-- TOC entry 3529 (class 1259 OID 17357)
-- Name: idx_producao_checklist_pedido; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_producao_checklist_pedido ON public.producao_checklist USING btree (pedido_id);


--
-- TOC entry 3530 (class 1259 OID 17358)
-- Name: idx_producao_checklist_responsavel; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_producao_checklist_responsavel ON public.producao_checklist USING btree (responsavel_id);


--
-- TOC entry 3473 (class 1259 OID 16938)
-- Name: idx_producao_pedido; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_producao_pedido ON public.producao_status USING btree (pedido_id);


--
-- TOC entry 3505 (class 1259 OID 17094)
-- Name: idx_produtos_ativo; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_produtos_ativo ON public.produtos_catalogo USING btree (ativo);


--
-- TOC entry 3489 (class 1259 OID 17031)
-- Name: idx_produtos_categoria; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_produtos_categoria ON public.produtos_estoque USING btree (categoria_id);


--
-- TOC entry 3490 (class 1259 OID 17030)
-- Name: idx_produtos_codigo; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_produtos_codigo ON public.produtos_estoque USING btree (codigo);


--
-- TOC entry 3491 (class 1259 OID 17032)
-- Name: idx_produtos_estoque_baixo; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_produtos_estoque_baixo ON public.produtos_estoque USING btree (quantidade_atual, estoque_minimo);


--
-- TOC entry 3506 (class 1259 OID 17093)
-- Name: idx_produtos_nome; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_produtos_nome ON public.produtos_catalogo USING btree (nome);


--
-- TOC entry 3513 (class 1259 OID 17197)
-- Name: idx_sistema_logs_acao; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_sistema_logs_acao ON public.sistema_logs USING btree (acao);


--
-- TOC entry 3514 (class 1259 OID 17198)
-- Name: idx_sistema_logs_created_at; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_sistema_logs_created_at ON public.sistema_logs USING btree (created_at);


--
-- TOC entry 3515 (class 1259 OID 17196)
-- Name: idx_sistema_logs_usuario_id; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_sistema_logs_usuario_id ON public.sistema_logs USING btree (usuario_id);


--
-- TOC entry 3446 (class 1259 OID 16968)
-- Name: idx_usuarios_email; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_usuarios_email ON public.usuarios USING btree (email);


--
-- TOC entry 3447 (class 1259 OID 16969)
-- Name: idx_usuarios_perfil; Type: INDEX; Schema: public; Owner: brbandeiras
--

CREATE INDEX idx_usuarios_perfil ON public.usuarios USING btree (perfil);


--
-- TOC entry 3575 (class 2620 OID 17366)
-- Name: producao_checklist trigger_atualizar_tempo_producao; Type: TRIGGER; Schema: public; Owner: brbandeiras
--

CREATE TRIGGER trigger_atualizar_tempo_producao BEFORE UPDATE ON public.producao_checklist FOR EACH ROW EXECUTE FUNCTION public.atualizar_tempo_producao();


--
-- TOC entry 3573 (class 2620 OID 17504)
-- Name: clientes update_clientes_updated_at; Type: TRIGGER; Schema: public; Owner: brbandeiras
--

CREATE TRIGGER update_clientes_updated_at BEFORE UPDATE ON public.clientes FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();


--
-- TOC entry 3576 (class 2620 OID 17505)
-- Name: pedido_arte update_pedido_arte_updated_at; Type: TRIGGER; Schema: public; Owner: brbandeiras
--

CREATE TRIGGER update_pedido_arte_updated_at BEFORE UPDATE ON public.pedido_arte FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();


--
-- TOC entry 3574 (class 2620 OID 17503)
-- Name: pedidos update_pedidos_updated_at; Type: TRIGGER; Schema: public; Owner: brbandeiras
--

CREATE TRIGGER update_pedidos_updated_at BEFORE UPDATE ON public.pedidos FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();


--
-- TOC entry 3572 (class 2620 OID 17506)
-- Name: usuarios update_usuarios_updated_at; Type: TRIGGER; Schema: public; Owner: brbandeiras
--

CREATE TRIGGER update_usuarios_updated_at BEFORE UPDATE ON public.usuarios FOR EACH ROW EXECUTE FUNCTION public.update_updated_at_column();


--
-- TOC entry 3565 (class 2606 OID 17191)
-- Name: anexos anexos_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.anexos
    ADD CONSTRAINT anexos_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3568 (class 2606 OID 17466)
-- Name: arte_versoes arte_versoes_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.arte_versoes
    ADD CONSTRAINT arte_versoes_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id) ON DELETE CASCADE;


--
-- TOC entry 3569 (class 2606 OID 17471)
-- Name: arte_versoes arte_versoes_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.arte_versoes
    ADD CONSTRAINT arte_versoes_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3555 (class 2606 OID 16929)
-- Name: logs_acesso logs_acesso_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.logs_acesso
    ADD CONSTRAINT logs_acesso_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3556 (class 2606 OID 16961)
-- Name: logs_sistema logs_sistema_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.logs_sistema
    ADD CONSTRAINT logs_sistema_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3558 (class 2606 OID 17020)
-- Name: movimentacoes_estoque movimentacoes_estoque_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.movimentacoes_estoque
    ADD CONSTRAINT movimentacoes_estoque_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id);


--
-- TOC entry 3559 (class 2606 OID 17015)
-- Name: movimentacoes_estoque movimentacoes_estoque_produto_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.movimentacoes_estoque
    ADD CONSTRAINT movimentacoes_estoque_produto_id_fkey FOREIGN KEY (produto_id) REFERENCES public.produtos_estoque(id);


--
-- TOC entry 3560 (class 2606 OID 17025)
-- Name: movimentacoes_estoque movimentacoes_estoque_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.movimentacoes_estoque
    ADD CONSTRAINT movimentacoes_estoque_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3564 (class 2606 OID 17176)
-- Name: notificacoes notificacoes_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.notificacoes
    ADD CONSTRAINT notificacoes_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3550 (class 2606 OID 16891)
-- Name: pedido_arquivos pedido_arquivos_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arquivos
    ADD CONSTRAINT pedido_arquivos_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id) ON DELETE CASCADE;


--
-- TOC entry 3551 (class 2606 OID 16896)
-- Name: pedido_arquivos pedido_arquivos_uploaded_by_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arquivos
    ADD CONSTRAINT pedido_arquivos_uploaded_by_fkey FOREIGN KEY (uploaded_by) REFERENCES public.usuarios(id);


--
-- TOC entry 3552 (class 2606 OID 17104)
-- Name: pedido_arquivos pedido_arquivos_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arquivos
    ADD CONSTRAINT pedido_arquivos_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3570 (class 2606 OID 17492)
-- Name: pedido_arte pedido_arte_arte_finalista_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arte
    ADD CONSTRAINT pedido_arte_arte_finalista_id_fkey FOREIGN KEY (arte_finalista_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3571 (class 2606 OID 17487)
-- Name: pedido_arte pedido_arte_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_arte
    ADD CONSTRAINT pedido_arte_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id) ON DELETE CASCADE;


--
-- TOC entry 3548 (class 2606 OID 16876)
-- Name: pedido_itens pedido_itens_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_itens
    ADD CONSTRAINT pedido_itens_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id) ON DELETE CASCADE;


--
-- TOC entry 3549 (class 2606 OID 17095)
-- Name: pedido_itens pedido_itens_produto_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedido_itens
    ADD CONSTRAINT pedido_itens_produto_id_fkey FOREIGN KEY (produto_id) REFERENCES public.produtos_catalogo(id);


--
-- TOC entry 3543 (class 2606 OID 17109)
-- Name: pedidos pedidos_arte_finalista_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_arte_finalista_id_fkey FOREIGN KEY (arte_finalista_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3544 (class 2606 OID 16856)
-- Name: pedidos pedidos_cliente_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_cliente_id_fkey FOREIGN KEY (cliente_id) REFERENCES public.clientes(id);


--
-- TOC entry 3545 (class 2606 OID 17286)
-- Name: pedidos pedidos_responsavel_atual_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_responsavel_atual_id_fkey FOREIGN KEY (responsavel_atual_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3546 (class 2606 OID 17326)
-- Name: pedidos pedidos_responsavel_producao_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_responsavel_producao_id_fkey FOREIGN KEY (responsavel_producao_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3547 (class 2606 OID 16861)
-- Name: pedidos pedidos_vendedor_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.pedidos
    ADD CONSTRAINT pedidos_vendedor_id_fkey FOREIGN KEY (vendedor_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3566 (class 2606 OID 17347)
-- Name: producao_checklist producao_checklist_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_checklist
    ADD CONSTRAINT producao_checklist_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id) ON DELETE CASCADE;


--
-- TOC entry 3567 (class 2606 OID 17352)
-- Name: producao_checklist producao_checklist_responsavel_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_checklist
    ADD CONSTRAINT producao_checklist_responsavel_id_fkey FOREIGN KEY (responsavel_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3553 (class 2606 OID 16911)
-- Name: producao_status producao_status_pedido_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_status
    ADD CONSTRAINT producao_status_pedido_id_fkey FOREIGN KEY (pedido_id) REFERENCES public.pedidos(id);


--
-- TOC entry 3554 (class 2606 OID 16916)
-- Name: producao_status producao_status_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.producao_status
    ADD CONSTRAINT producao_status_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


--
-- TOC entry 3561 (class 2606 OID 17072)
-- Name: produtos_catalogo produtos_catalogo_categoria_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_catalogo
    ADD CONSTRAINT produtos_catalogo_categoria_id_fkey FOREIGN KEY (categoria_id) REFERENCES public.categorias_produtos(id);


--
-- TOC entry 3557 (class 2606 OID 17000)
-- Name: produtos_estoque produtos_estoque_categoria_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_estoque
    ADD CONSTRAINT produtos_estoque_categoria_id_fkey FOREIGN KEY (categoria_id) REFERENCES public.categorias_estoque(id);


--
-- TOC entry 3562 (class 2606 OID 17088)
-- Name: produtos_imagens produtos_imagens_produto_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.produtos_imagens
    ADD CONSTRAINT produtos_imagens_produto_id_fkey FOREIGN KEY (produto_id) REFERENCES public.produtos_catalogo(id) ON DELETE CASCADE;


--
-- TOC entry 3563 (class 2606 OID 17145)
-- Name: sistema_logs sistema_logs_usuario_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: brbandeiras
--

ALTER TABLE ONLY public.sistema_logs
    ADD CONSTRAINT sistema_logs_usuario_id_fkey FOREIGN KEY (usuario_id) REFERENCES public.usuarios(id);


-- Completed on 2025-08-27 21:27:50 UTC

--
-- PostgreSQL database dump complete
--

